%************************************************
\chapter{Cálculo de la homología singular}\label{ch:introduccion}
%************************************************

En esta parte, vamos a enunciar y demostrar el teorema de subdivisión baricéntrica,
el cual nos permite calcular directa o indirectamente (a través de sus consecuencias)
el grupo de homología de ciertos espacios topológicos, como haremos con las esferas
n-dimensionales.

\section{Teorema de subdivisión baricéntrica}

\begin{definition}
  Sea $\X$ un espacio topológico. Diremos que $\U \subseteq \mathcal P(\X)$ es un recubrimiento de $\X$ si $\X = \bigcup\limits_{U \in \U} U$.
\end{definition}

Tomemos ahora $\X$ un espacio topológico y $\U$ un recubrimiento suyo. Para $ p \geq 0$, podemos definir
\[ F_p^\U(\X) = \{\phi \in F_p(\X) \mid \exists U \in \U \text{ tal que } \Img \phi \subseteq U\} \]
que es, por definición, subconjunto de $F_p(\X)$.

Si $S_p^\U(\X)$ es el grupo abeliano libre generado por $F_p^\U(\X)$, por $F_p^\U(\X) \subseteq F_p(\X)$, se tiene
que $S_p^\U(\X)$ es un subgrupo de $S_p(\X)$. Si consideramos la inclusión $i \colon S_p^\U(\X) \to S_p(\X)$, si
$\phi \in F_p^\U(\X)$, entonces $\partial_i(\phi) \in F_{p-1}^\U(\X)$ y así, $\partial(\phi) \in S_{p-1}^\U(\X)$. \\
En consecuencia, la restricción del borde a $S_p^\U(\X)$ define un homomorfismo borde, y así, construímos un complejo
de cadenas $S_*^\U(\X) = \{S_p^\U(\X), \partial\}_{p \geq 0}$.

Este complejo es un subcomplejo de $S_*(\X)$. Si tomamos la inclusión $i \colon S_*^\U(\X) \to S_*(\X)$, induce un
homomorfismo en la homología, $i_* \colon H_p(S_*^\U(\X)) \to H_p(\X) \hspace{0.2em} \forall p \geq 0$, donde
$H_p(S_*^\U(\X)) = \frac{\Ker \partial}{\Img \partial}$

Sea ahora $\Y$ otro espacio topológico, y $\V$ un recubrimiento suyo. Diremos que una función continua $f \colon \X \to \Y$ es compatible
con $\U, \V$ si $\forall U \in \U \exists V \in \V$ tal que $f(U) \subseteq V$. En tal caso, puede definirse un homomorfismo
$f_\# \colon S_p^\U(\X) \to S_p^\V(\Y)$ dado por la restricción de $f_\# \colon \SX{p} \to \SY{p} a S_p^\U(\X)$.

Esto hace que el siguiente diagrama sea conmutativo:
\[ \begin{tikzcd}
  S_p^\U(\X) \arrow{r}{f_\#} \arrow{d}{i} & S_p^\V(\Y) \arrow{d}{i} \\
  \SX{p} \arrow{r}{f_\#} & \SY{p}
\end{tikzcd} \]

\begin{remark}
  El diagrama conmutativo está bien definido, pues si $\phi \in F_p^\U(\X)$, entonces existe $U \in \U$ con $\Img \phi \subseteq U$, de donde
  $f_\#(\phi) = f \circ \phi$ verifica $\Img(f \circ \phi) \subseteq f(U) \subseteq V \in \V$.
\end{remark}

Como $f_\# \partial = \partial f_\#$, $f$ induce $f_* \colon H_p(S_p^\U(\X)) \to H_p(S_p^\V(\Y))$.

\begin{theorem}[Teorema de subdivisión baricéntrica]
  Sean $\X$ un espacio topológico y $\U$ un recubrimiento de $\X$ tal que $\interior{\U} = \{\interior{U} \mid U \in \U\}$
  también recubra a $\X$. Entonces la aplicación
  \[ i_* \colon H_p(S_*^\U(\X)) \to H_p(\X) \]
  es un isomorfismo, $\forall p \geq 0$.

  Además, si $(\Y, \V)$ es otro par de las mismas características, y $f \colon \X \to \Y$ es una función continua
  compatible con $\U, \V$, entonces el siguiente diagrama es conmutativo:
  \[ \begin{tikzcd}
    H_p(S_*^\U(\X)) \arrow{r}{i_*} \arrow{d}{f_*} & H_p(\X) \arrow{d}{f_*} \\
    H_p(S_*^\V(\Y)) \arrow{r}{i_*} & H_p(\Y)
  \end{tikzcd} \]

\end{theorem}

Antes de pasar a la demostración del teorema, necesitaremos introducir nuevos conceptos. La idea es definir la subdivisión
de símplices singulares mediante la subdivisión baricéntrica de símplices, que nos llevan a poder dar una especie de
inversa homotópica de la inclusión.

\section{Subdivisión de símplices}

\begin{definition}
  Sea $s_p = (a_0, \dots, a_p)$ un p-símplice. Definimos el baricentro de $s_p$ como
  \[b(s_p) = \frac{a_0 + \dots + a_p}{p+1}\]
\end{definition}

Los puntos $\{b(s_p), a_0, \dots, a_{i-1}, a_{i+1}, \dots, a_p\}$ genera un p-símplice $\forall i = 0, \dots, p$.
Definimos la subdivisión baricéntrica del símplice $s_p$ por inducción sobre $p$, y la notamos $Sd(s_p)$.
\begin{itemize}
  \item $Sd(s_0) = s_0$
  \item $Sd(s_p) = (b(s_p), t_0, \dots, t_{p-1}) \mid (t_0, \dots, t_{p-1}) \in Sd(\U_{p-1}), \U_{p-1} \in \interior{S_p}$
        siendo $\interior{S_p}$ el conjunto de caras de orden $p-1$ de $S_p$.
\end{itemize}

\begin{remark}
  Es importante destacar que el orden en el que se ponen los puntos es importante, pues si el baricentro fuera en otro lugar,
  la orientación del símplice cambiaría, y afectaría al cálculo del borde.
\end{remark}

Si $K$ es un conjunto de símplices, la subdivisión de $K$ vienen dada por $Sd(K) = \bigcup\limits_{s_p \in K} Sd(s_p)$.

Se define la n-ésima subdivisión como \[Sd^n(s_p) = Sd(Sd^{n-1}(s_p)), \text{ con } Sd^1 = Sd \]

\begin{proposition}
  Sea $t_p \in Sd(s_p)$ un p-símplice de la subdivisión. Entonces $diam(t_p) \leq \frac{p}{p+1} diam(s_p)$.
\end{proposition}

\begin{proof}
  Haremos la demostración por inducción sobre $p$.

  Para $p = 0$, se tiene $0 = 0$.

  Supuesto cierto hasta $p-1$, lo probamos para $p$.

  Sea $s_p = (a_0, \dots, a_p)$. Se verifica que $diam(s_p) = \max\limits_{i,j} |a_i - a_j|$.
  Como $t_p \in Sd(s_p), t_p = (b(s_p), t_0, \dots, t_{p-1}) \in Sd(\U_{p-1})$.
  Entonces, $diam(t_p) = max\{|b(s_p) - t_i|,\hspace{0.2em} |t_i - t_j|, i,j = 0, \dots, p-1\}$.

  Por h. de inducción sabemos que $|t_i - t_j| \leq diam(t_0, \dots, t_{p-1}) \leq \frac{p-1}{p} diam(\U_{p-1})$.
  Como $U_{p-1} \subseteq s_p$, entonces $diam(U_{p-1}) \leq diam(s_p)$, y como $\frac{p-1}{p} \leq \frac{p}{p+1}$
  se tiene $|t_i - t_j| \leq \frac{p}{p+1} diam(s_p)$

  Además, $|b(s_p) - t_i| \leq \max\limits_i |b(s_p) - a_i| = \max\limits_i |\frac{a_0 + \dots + a_p}{p-1} - a_i| =
  \max\limits_i | \frac{\sum\limits_{i \neq j} |a_j - a_i|}{p+1} \leq \frac{p}{p+1} diam(s_p)$
\end{proof}

\begin{definition}
  Sea $\varphi$ una colección de subconjuntos acotados de un espacio euclídeo. Definimos $malla \varphi = \sup\limits{c \in \varphi} diam(c)$
\end{definition}

\begin{corollary}
  Si $K$ es una colección de p-símplices, se verifica \[malla(Sd(K)) \leq \frac{p}{p+1} malla(K) \]
\end{corollary}

\begin{corollary}
  Si $K$ es una colección finita de p-símplices, entonces $\forall \epsilon > 0, \exists n \in \N$ tal que \\$malla(Sd^n(k)) < \epsilon$
\end{corollary}

\begin{proof}
  Simplemente aplicamos $\lim\limits_{n \to \infty}(\frac{p}{p+1})^n = 0$
\end{proof}

\section{Subdivisión baricéntrica de símplices singulares afines}

Vamos a tratar ahora la subdivisión de símplices singulares afines. Estos nos permitirán aproximar la
subdivisión de cualquier símplice singular, por lo que su estudio nos resulta de gran interés.

Sea $C$ un subconjunto convexo del espacio euclídoe en el que trabajamos. Para todo $p \geq 0$, sea
\[F_p^A(C) = \{ \phi \in F_p(C) \mid \phi \text{ es una aplicación afín}\} \]
es decir, $\phi \colon \sigma_p \to C \quad$ verifica \[\phi(ta + (1-t)b) = t\phi(a) + (1-t)\phi(b) \hspace{1em} \forall t \in [0,1]\]

Sea $A_p(C)$ el grupo abeliano libre generado por $F_p^A(C)$, subgrupo libre de $S_p(C)$. Si $\phi \in F_p^A(C), \partial_i \phi = \phi \circ F_p^i$,
y como $\phi$ es afín y $F_p^i$ también, $\partial_i \phi$ es afín. Así:
\[\partial \phi = \sum\limits_{i = 0}^p (-1)^1 \partial_i \phi \hspace{0.5em} \in A_{p-1}(C)\]

Es consecuencia, podemos restringir el borde a $A_p(C)$, haciendo conmutativo
\[ \begin{tikzcd}
      A_p(C) \arrow{r}{\partial} \arrow{d}{i} & A_{p-1}(C) \arrow{d}{i} \\
      S_p(C) \arrow{r}{\partial} & S_{p-1}(C)
\end{tikzcd} \]

Tenemos pues un complejo de cadenas $A_*(C) = \{A_p(C), \partial\}_{p \geq 0}$, para todo convexo $C$.

Si $\phi \in F_p^A(C), \phi \colon \sigma_p \to C$ afín. Notando $\sigma_p = (v_0, \dots, v_p)$, entonces
${x_i = \phi(v_i) \in C}$ determinan unívocamente a $\phi$, pues si $v = \sum\limits_{i = 0}^p \alpha_i v_i$, entonces
$\phi(v) = \sum\limits_{i = 0}^p \alpha_i \phi(v_i)$ por afinidad. Por tanto, todo elemento de $\phi \in F_p^A(C)$ se
identifica con $p+1$ puntos de $C$.
\[\phi \in F_p^A(C) \equiv \{x_0, \dots, x_p\} \subseteq C\]

Además, $\partial \phi = \sum\limits_{i = 0}^p (-1)^i \partial_i \phi$, con $\partial_i \phi = \{x_0, \dots, \hat{x_i}, \dots, x_p\}$

En consecuencia, $A_p(C)$ es el grupo abeliano libre sobre:
\[\{(x_0, \dots, x_p) \mid x_i \in C\} \equiv C \times \dots \times C \]
y el operador borde lo da $\partial(\{x_0, \dots, x_p\}) = \sum\limits_{i = 0}^p (-1)^i \{x_0, \dots, \hat{x_i}, \dots, x_p\}$

Si tenemos $C, C'$ convexos, y $f \colon C \to C'$ es una aplicación afín (y por tanto continua), al tomar la restricción de $f_\#$
a $A_p(C)$, se tiene que si ${\phi \in F_p^A(C)}$ entonces $f_\#(\phi) = {f \circ \phi \in F_p^A(C')} \implies {f_\#(A_p(C)) \subseteq A_p(C')}$

En consecuencia, $\partial f_\# = f_\# \partial$ y $f_\# \colon A_*(C) \to A_*(C')$ es una aplicación de cadenas. Además,
${f_\#(\{x_0, \dots, x_p\}) = \{f(x_0), \dots, f(x_p)\}}$

\begin{definition}
  Sea $x \in C$ Definimos
  \begin{align*}
    \C_x \colon A_p(C) &\to A_{p+1}(C) \\
    \{x_0, \dots, x_p\} &\mapsto \{x, x_0, \dots, x_p\}
  \end{align*}
  y la extendemos por linealidad a un homomorfismo, pues tenemos los valores de los generadores.
\end{definition}

\begin{proposition}
  Veamos que:
  \begin{itemize}
    \item[a)] $\partial \C_x + \C_x \partial = Id_{A_p(C)} \quad \forall p \geq 1$
    \item[b)] $f_\# \C_x = \C_{f(x)} f_\# \quad \forall f \colon C \to C'$ afín.
  \end{itemize}
\end{proposition}

\begin{proof}
  a) $\partial \C_x(x_0, \dots, x_p) = \partial(x, x_0, \dots, x_p) = \{x_0, \dots, x_p\} + \\ \sum\limits_{i = 1}^{p+1} (-1)^i \partial_i (x, x_0, \dots, x_p)
  = \{x_0, \dots, x_p\} + \sum\limits_{j = 0}^{p} (-1)^{j+1} \partial_{j+1} (x, x_0, \dots, x_p)
  = \{x_0, \dots, x_p\} - \sum\limits_{j = 0}^{p} (-1)^j \C_x(x_0, \dots, \hat{x_j}, \dots, x_p) = \{x_0, \dots, x_p\} - \C_x \partial(x_0, \dots, x_p)$

  b) $f_\# \C_x(x_0, \dots, x_p) = f_\#(x, x_0, \dots, x_p) = (f(x), f(x_0), \dots, f(x_p)) = \C_{f(x)} f_\#(x_0, \dots, x_p)$
\end{proof}

Ahora podemos definir una subdivisión para símplices o cadenas afines. Lo haremos por inducción, definiendo ${Sd' \colon A_p(C) \to A_p(C)}$

$\fbox{p = 0}$
\[Sd' = Id_{A_p(C)}\]

$\fbox{p > 0}$, supuesto definido hasta $p-1$
\[ Sd'(\phi) = \C_{b(\phi)}(Sd' \circ \partial \phi) \]
donde $b(\phi) = \frac{x_0 + \dots + x_p}{p+1}$, siendo $\phi = \{x_0, \dots, x_p\}$ y extendido linealmente.

Veamos algunas propiedades. Debido a que la definición se hizo por inducción, todas las demostraciones serán por inducción.

a) $\partial \circ Sd' = Sd' \circ \partial$

\begin{proof}
  Para $p = 0$ la demostración es trivial, por la definición de $Sd'$. Suponemos $p \geq 1$.

  Sea $\phi \in F_p^A(C)$, entonces
  \begin{align*}
    \partial \circ Sd'(\phi) &= \partial \C_{b(\phi)} Sd' \partial \phi = Sd'(\partial \phi) - \C_{b(\phi)} \partial Sd'(\partial \phi) \\
    &= Sd'(\partial \phi) - \C_{b(\phi)} Sd'(\partial^2 \phi) = Sd'(\partial \phi)
  \end{align*}
\end{proof}

b) Si $f \colon C \to C'$ es afín, entonces $f_\# \circ Sd' = Sd' \circ f_\#$

\begin{proof}
  $(f_\# Sd')(\phi) = f_\#(\C_{b(\phi)} Sd'(\partial(\phi))) = \C_{f(b(\phi))} f_\# Sd'(\partial(\phi))\\ \stackrel{\text{h. de i}}{=}
  \C_{f(b(\phi))} Sd'(f_\#(\partial(\phi))) = \C_{f(b(\phi))} Sd'(\partial(f_\#(\phi))) = Sd'(f_\#(\phi))$
\end{proof}

c) Existe un homomorfismo $\tau' \colon A_p(C) \to A_{p+1}(C)$ tal que ${\partial \tau' + \tau' \partial = Sd' - Id_{A_p(C)}}$,
es decir, $Sd'$ es, como aplicación de cadenas, homotópica a la identidad.

\begin{proof}
  Para $p = 0$, tomamos $\tau' = 0$

  Supuesto cierto hasta $p-1$, buscamos $\tau' \colon A_p(C) \to A_{p+1}(C)$ verificando
  \[\partial \tau' = Sd' - I_{A_p(C)} - \tau' \partial\]

  Como el segundo miembro es conocido, entonces si $\phi \in F_p^A(C), \tau'(\phi)$ ha de verificar
  \[\partial(\tau'(\phi)) = Sd'(\phi) - \phi - \tau'(\partial(\phi))\]
  lo calculamos
  \begin{align*}
    &\partial(Sd'(\phi) - \phi - \tau'(\partial(\phi)) = Sd'(\partial(\phi)) - \partial(\phi) - \partial(\tau' \partial(\phi)) \\
    &= Sd'(\partial(\phi)) - \partial(\phi) + \tau'(\partial^2(\phi)) - Sd'(\partial(\phi)) + \partial(\phi) = 0
  \end{align*}
  Definiendo $\tau'(\phi) = \C_{b(\phi)}(Sd'(\phi) - \phi - \tau'(\partial(\phi))$, entonces
  \begin{align*}
    &\partial(\tau'(\phi)) = \partial \C_{b(\phi)}(Sd'(\phi) - \phi -\tau'(\partial(\phi))) = (Sd'(\phi) - \phi - \tau' \partial(\phi)) \\
    &- \C_{b(\phi)} \partial(Sd'(\phi) - \phi - \tau'(\partial(\phi))) = Sd'(\phi) - \phi - \tau'(\partial(\phi))
  \end{align*}
\end{proof}

d) $\tau'$ es natural, esto es, si $f \colon C \to C'$ es afín, entonces $f_\# \tau' = \tau' f_\#$

\begin{proof}
  Para $p = 0$ es trivial por definición.

  Suponemos cierto hasta $p-1$. Sea $\phi \in F_p^A(C)$, entonces
  \begin{align*}
    &f_\#(\tau'(\phi)) = f_\#(\C_{b(\phi)}(Sd'(\phi) - \phi - \tau'(\partial(\phi))) \\
    &= \C_{f(b(\phi))} f_\#(Sd'(\phi) - \phi - \tau(\partial(\phi))) \\
    &= \C_{f(b(\phi))}(Sd'(f_\# \phi) - f_\# \phi - \tau'(f_\# \partial(\phi))) = \tau'(f_\#(\phi))
  \end{align*}
\end{proof}

e) Propiedad técnica. Nos permitirá subdividir símplices hasta que estos queden dentro del recubrimiento.

Sea $c = \sigma_p$ y $\tau_p \colon \sigma_p \to \sigma_p$ la identidad ($\tau_p \in F_p^A(\sigma_p)$). \\
Si $Sd'(\tau_p) = \sum_i n_i \phi_i$ (que ocurre siempre), con $\phi_i \colon \sigma_p \to \sigma_p$ afines, entonces
$\forall i \hspace{0.3em} \exists t_p^i \in Sd(\sigma_p)$ tal que $\Img(\phi_i) \subseteq t_p^i$.

\begin{proof}
  Para $p = 0$, $Sd'(\tau_0) = \tau_0 = \sigma_0$. Siendo $t_0^i = \sigma_0 = Sd'(\sigma_0)$.

  Supuesto cierto hasta $p-1$, sea $Sd'(\tau_p) = \C_{b(\tau_p)} Sd'(\partial(\tau_p))$
  \begin{align*}
    &\partial(\tau_p) = \sum\limits_{i = 0}^p (-1)^i \partial_i(\tau_p) = \sum\limits_{i = 0}^p (-1)^i \tau_p \circ F_p^i = (por ser la identidad) \\
    &= \sum\limits_{i = 0}^p (-1)^i F_p^i \circ \tau_{p-1} = \sum\limits_{i = 0}^p (-1)^i(F_p^i)_\# (\tau_{p-1}) \text{. De esta forma:} \\
    &Sd'(\tau_p) = \C_{b(\tau_p)}(\sum\limits_{i = 0}^p (-1)^i Sd'(F_p^i)_\# (\tau_{p-1})) = \C_{b(\tau_p)}(\sum\limits_{i = 0}^p (-1)^i(F_p^i)_\# Sd'(\tau_{p-1})) \\
  \end{align*}
  Si $Sd'(\tau_{p-1}) = \sum\limits_j m_j \psi_j$, entonces, por inducción, $\forall j$ existe $t_{p-1}^j \in Sd(\sigma_{p-1})$ tal que
  $\Img(\psi_j) \subseteq t_{p-1}^j$.

  Por tanto, $Sd'(\tau_p) = \sum\limits_{i = 0}^p \sum\limits_j (-1)^i m_j C_{b(\tau_p)}(F_p^i)_\# (\psi_j)$

  Como $\Img(\psi_j) \subseteq t_{p-1}^j \in Sd(\sigma_{p-1})$
  $\Img((F_p^i)_\# (\psi_j)) = \Img(F_p^i \circ \psi_j) \subseteq F_p^i(\Img(\psi_j)) \subseteq F_p^i(t_{p-1}^j) \in Sd(\interior{\sigma_p})$,
  luego $\Img((F_p^i)_\# (\psi_j)) \subseteq U_{p-1}^{i,j} \in Sd(\interior{\sigma_p})$.

  Así, $\Img(\C_{b(\tau_p)}(F_p^i)_\# (\phi_j)) \subseteq \C_{b(\tau_p)}(U_{p-1}^{i, j}) = (b(\sigma_p), t_0, \dots, t_{p-1}) \in Sd(\sigma_p)$.\\
  (Donde $U_{p-1}^{i,j} = (t_0, \dots, t_p)$)
\end{proof}
